"use strict";$((()=>{class t{constructor(){this.totalPrice=0,this.productsList=new Map,this.xhr=new XMLHttpRequest,this.xhr.open("GET","/prodcts.xml"),this.xhr.responseType="document",this.xhr.send(),this.xhr.onload=()=>{if(null!=localStorage.getItem("products_list")){this.productsList=new Map(JSON.parse(localStorage.getItem("products_list")));for(let t of this.productsList.values())this.AddProduct(t.id,t.count)}}}AddProduct(t,e=1){let i=this.xhr.response.querySelector(`product[id="${t}"]`),r=new s(t,i.querySelector("title").innerHTML,i.querySelector("price").innerHTML,i.querySelector("img").getAttribute("src"),e);this.productsList.set(t,r),$("#basket .basket-products").append(`<div class="basket-product" id="${t}"><div class="basket-product-thumb"><div class="basket-product-imgdiv" style="background-image:url(${r.preview});"></div></div><div class="basket-product-title"><a href="/products/prodct${t}.html" target="_blank">${r.title}</a></div><div class="basket-product-plusminus"><span class="basket-product-minus"><img src="/img/minus.svg" style="width:16px;height:16px;border:0"></span><span class="basket-product-quantity">${r.count}</span><span class="basket-product-plus"><img src="/img/plus.svg" style="width:16px;height:16px;border:0"></span></div><div class="basket-product-amount">${r.price*r.count} грн.</div><div class="basket-product-del"><img src="/img/remove.svg" style="width:20px;height:20px;border:0;"></div></div>`),this.CommitBasket()}RemoveProduct(t){$("#"+t).remove(),this.productsList.delete(t),this.CommitBasket()}IncCount(t){$(`#${t} .basket-product-quantity`).html(String(++this.productsList.get(t).count)),$(`#${t} .basket-product-amount`).html(this.productsList.get(t).count*this.productsList.get(t).price+" грн"),this.CommitBasket()}DecCount(t){$(`#${t} .basket-product-quantity`).html(String(--this.productsList.get(t).count)),$(`#${t} .basket-product-amount`).html(this.productsList.get(t).count*this.productsList.get(t).price+" грн"),this.CommitBasket()}TotalPrice(){let t=0;for(let s of this.productsList.values())t+=s.price*s.count;return t}CommitBasket(){localStorage.setItem("products_list",JSON.stringify(Array.from(this.productsList.entries()))),$("#products_list").attr("value",JSON.stringify(Array.from(this.productsList.entries()))),$("#basket-counter").html(String(this.productsList.size)),$("#basket-counter").attr("data-amount",this.productsList.size),$("#total-price").html(`${this.TotalPrice()} грн`)}Clear(){this.productsList.clear(),this.CommitBasket(),localStorage.clear()}}class s{constructor(t,s,e,i,r=1){this.id=t,this.title=s,this.price=e,this.preview=i,this.count=r}}new class{constructor(){this.basket=null,this.BurgerMenuInit(),this.TimerInit(),this.BasketInit()}BurgerMenuInit(){let t=$("#ctg-s");"ontouchstart"in window||navigator.maxTouchPoints?(t.on("touchend",(()=>$("#submenu").toggleClass("active"))),$("#submenu").on("touchend",(()=>$(this).removeClass("active")))):(t.on("mouseenter",(()=>$("#submenu").addClass("active"))),t.on("mouseleave",(()=>$("#submenu").removeClass("active"))))}TimerInit(){new Date((t="2021-"+("0"+((new Date).getMonth()+2)).slice(-2)+"-01",+String(Date.parse(t)-Date.parse(String(new Date)))));var t;$("#counter").countdown("2021-"+("0"+((new Date).getMonth()+2)).slice(-2)+"-01")}BasketInit(){this.basket=new t;let s=this.basket;$("body").on("click",".btn-basket",(function(){let t=Number($(this).data("target"));s.Clear(),s.AddProduct(t)})),$("body").on("click",'[href="#close"]',(()=>{s.Clear()}))}}}));